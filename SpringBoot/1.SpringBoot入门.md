# Spring Boot å…¥é—¨

## 1. Spring Boot ç®€ä»‹

> ç®€åŒ–Springåº”ç”¨å¼€å‘çš„ä¸€ä¸ªæ¡†æ¶ï¼›
>
> æ•´ä¸ªSpringæŠ€æœ¯æ ˆçš„ä¸€ä¸ªå¤§æ•´åˆï¼›
>
> J2EEå¼€å‘çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼›

## 2. å¾®æœåŠ¡

2014ï¼Œmartin fowler

å¾®æœåŠ¡ï¼šæ¶æ„é£æ ¼ï¼ˆæœåŠ¡å¾®åŒ–ï¼‰

ä¸€ä¸ªåº”ç”¨åº”è¯¥æ˜¯ä¸€ç»„å°å‹æœåŠ¡ï¼›å¯ä»¥é€šè¿‡HTTPçš„æ–¹å¼è¿›è¡Œäº’é€šï¼›

å•ä½“åº”ç”¨ï¼šALL IN ONE

å¾®æœåŠ¡ï¼šæ¯ä¸€ä¸ªåŠŸèƒ½å…ƒç´ æœ€ç»ˆéƒ½æ˜¯ä¸€ä¸ªå¯ç‹¬ç«‹æ›¿æ¢å’Œç‹¬ç«‹å‡çº§çš„è½¯ä»¶å•å…ƒï¼›

[è¯¦ç»†å‚ç…§å¾®æœåŠ¡æ–‡æ¡£](https://martinfowler.com/articles/microservices.html#MicroservicesAndSoa)



## 3. ç¯å¢ƒå‡†å¤‡

### 3.1 MAVENè®¾ç½®ï¼›

ç»™maven çš„settings.xmlé…ç½®æ–‡ä»¶çš„profilesæ ‡ç­¾æ·»åŠ 

```xml
<profile>
  <id>jdk-1.8</id>
  <activation>
    <activeByDefault>true</activeByDefault>
    <jdk>1.8</jdk>
  </activation>
  <properties>
    <maven.compiler.source>1.8</maven.compiler.source>
    <maven.compiler.target>1.8</maven.compiler.target>
    <maven.compiler.compilerVersion>1.8</maven.compiler.compilerVersion>
  </properties>
</profile>
```

### 3.2 IDEAè®¾ç½®

æ•´åˆmavenè¿›æ¥ï¼›

![ideaè®¾ç½®](images/æœç‹—æˆªå›¾20180129151045.png)



![images/](images/æœç‹—æˆªå›¾20180129151112.png)

## 4. HelloWorld

ä¸€ä¸ªåŠŸèƒ½ï¼š

æµè§ˆå™¨å‘é€helloè¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥å—è¯·æ±‚å¹¶å¤„ç†ï¼Œå“åº”Hello Worldå­—ç¬¦ä¸²ï¼›

### 4.1 åˆ›å»ºä¸€ä¸ªmavenå·¥ç¨‹ï¼›

### 4.2 å¯¼å…¥spring bootç›¸å…³çš„ä¾èµ–

```xml
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>1.5.9.RELEASE</version>
    </parent>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
    </dependencies>
```

### 4.3 ç¼–å†™ä¸€ä¸ªä¸»ç¨‹åºï¼›å¯åŠ¨Spring Bootåº”ç”¨

```java

/**
 *  @SpringBootApplication æ¥æ ‡æ³¨ä¸€ä¸ªä¸»ç¨‹åºç±»ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªSpring Bootåº”ç”¨
 */
@SpringBootApplication
public class HelloWorldMainApplication {

    public static void main(String[] args) {

        // Springåº”ç”¨å¯åŠ¨èµ·æ¥
        SpringApplication.run(HelloWorldMainApplication.class,args);
    }
}
```

### 4.4 ç¼–å†™ç›¸å…³çš„Controllerã€Service

```java
@Controller
public class HelloController {

    @ResponseBody
    @RequestMapping("/hello")
    public String hello(){
        return "Hello World!";
    }
}

```



### 4.5 è¿è¡Œä¸»ç¨‹åºæµ‹è¯•

### 4.6 ç®€åŒ–éƒ¨ç½²

```xml
 <!-- è¿™ä¸ªæ’ä»¶ï¼Œå¯ä»¥å°†åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„jaråŒ…ï¼›-->
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>
```

å°†è¿™ä¸ªåº”ç”¨æ‰“æˆjaråŒ…ï¼Œç›´æ¥ä½¿ç”¨java -jarçš„å‘½ä»¤è¿›è¡Œæ‰§è¡Œï¼›

## 5. Hello Worldæ¢ç©¶

### 5.1 POMæ–‡ä»¶

#### 5.1.1 çˆ¶é¡¹ç›®

```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>1.5.9.RELEASE</version>
</parent>

ä»–çš„çˆ¶é¡¹ç›®æ˜¯
<parent>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-dependencies</artifactId>
  <version>1.5.9.RELEASE</version>
  <relativePath>../../spring-boot-dependencies</relativePath>
</parent>
ä»–æ¥çœŸæ­£ç®¡ç†Spring Bootåº”ç”¨é‡Œé¢çš„æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬ï¼›

```

Spring Bootçš„ç‰ˆæœ¬ä»²è£ä¸­å¿ƒï¼›

ä»¥åæˆ‘ä»¬å¯¼å…¥ä¾èµ–é»˜è®¤æ˜¯ä¸éœ€è¦å†™ç‰ˆæœ¬ï¼›ï¼ˆæ²¡æœ‰åœ¨dependenciesé‡Œé¢ç®¡ç†çš„ä¾èµ–è‡ªç„¶éœ€è¦å£°æ˜ç‰ˆæœ¬å·ï¼‰

#### 5.1.2 å¯åŠ¨å™¨

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
```

**spring-boot-starter**-webï¼šspring-boot-starterï¼šspring-bootåœºæ™¯å¯åŠ¨å™¨ï¼›**spring-boot-starter**-webå¸®æˆ‘ä»¬å¯¼å…¥äº†webæ¨¡å—æ­£å¸¸è¿è¡Œæ‰€ä¾èµ–çš„ç»„ä»¶ï¼›

Spring Bootå°†æ‰€æœ‰çš„åŠŸèƒ½åœºæ™¯éƒ½æŠ½å–å‡ºæ¥ï¼Œåšæˆä¸€ä¸ªä¸ªçš„startersï¼ˆå¯åŠ¨å™¨ï¼‰ï¼Œåªéœ€è¦åœ¨é¡¹ç›®é‡Œé¢å¼•å…¥è¿™äº›starterç›¸å…³åœºæ™¯çš„æ‰€æœ‰ä¾èµ–éƒ½ä¼šå¯¼å…¥è¿›æ¥ã€‚è¦ç”¨ä»€ä¹ˆåŠŸèƒ½å°±å¯¼å…¥ä»€ä¹ˆåœºæ™¯çš„å¯åŠ¨å™¨

### 5.2 ä¸»å…¥å£ç±»

```java
/**
 *  @SpringBootApplication æ¥æ ‡æ³¨ä¸€ä¸ªä¸»ç¨‹åºç±»ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªSpring Bootåº”ç”¨
 */
@SpringBootApplication
public class HelloWorldMainApplication {

    public static void main(String[] args) {

        // Springåº”ç”¨å¯åŠ¨èµ·æ¥
        SpringApplication.run(HelloWorldMainApplication.class,args);
    }
}

```

@**SpringBootApplication**:    Spring Bootåº”ç”¨æ ‡æ³¨åœ¨æŸä¸ªç±»ä¸Šè¯´æ˜è¿™ä¸ªç±»æ˜¯SpringBootçš„ä¸»é…ç½®ç±»ï¼ŒSpringBootå°±åº”è¯¥è¿è¡Œè¿™ä¸ªç±»çš„mainæ–¹æ³•æ¥å¯åŠ¨SpringBootåº”ç”¨ï¼›ç”±ä»¥ä¸‹æ³¨è§£å¤åˆè€Œæˆï¼š

```java
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@SpringBootConfiguration
@EnableAutoConfiguration
@ComponentScan(excludeFilters = {
      @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),
      @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) })
public @interface SpringBootApplication {
```

- @**SpringBootConfiguration**:Spring Bootçš„é…ç½®ç±»ï¼›æ ‡æ³¨åœ¨æŸä¸ªç±»ä¸Šï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªSpring Bootçš„é…ç½®ç±»ï¼›
  - @**Configuration**:é…ç½®ç±»ä¸Šæ¥æ ‡æ³¨è¿™ä¸ªæ³¨è§£ï¼›é…ç½®ç±»ç›¸å½“äºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼›é…ç½®ç±»ä¹Ÿæ˜¯å®¹å™¨ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼›@Component

- @**EnableAutoConfiguration**ï¼šå¼€å¯è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼›

â€‹		ä»¥å‰æˆ‘ä»¬éœ€è¦é…ç½®çš„ä¸œè¥¿ï¼ŒSpring Bootå¸®æˆ‘ä»¬è‡ªåŠ¨é…ç½®ï¼›@**EnableAutoConfiguration**å‘Šè¯‰SpringBootå¼€å¯è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼›è¿™æ ·è‡ªåŠ¨é…ç½®æ‰èƒ½ç”Ÿæ•ˆï¼›

```java
@AutoConfigurationPackage
@Import(EnableAutoConfigurationImportSelector.class)
public @interface EnableAutoConfiguration {
```

â€‹      	@**AutoConfigurationPackage**ï¼šè‡ªåŠ¨é…ç½®åŒ…

â€‹		@**Import**(AutoConfigurationPackages.Registrar.class)ï¼š

â€‹		Springçš„åº•å±‚æ³¨è§£@Importï¼Œç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶ï¼›å¯¼å…¥çš„ç»„ä»¶ç”±AutoConfigurationPackages.Registrar.classï¼›

==å°†ä¸»é…ç½®ç±»ï¼ˆ@SpringBootApplicationæ ‡æ³¨çš„ç±»ï¼‰çš„æ‰€åœ¨åŒ…åŠä¸‹é¢æ‰€æœ‰å­åŒ…é‡Œé¢çš„æ‰€æœ‰ç»„ä»¶æ‰«æåˆ°Springå®¹å™¨ï¼›==

â€‹	@**Import**(EnableAutoConfigurationImportSelector.class)ï¼›

â€‹		ç»™å®¹å™¨ä¸­å¯¼å…¥ç»„ä»¶ã€‚

â€‹		**EnableAutoConfigurationImportSelector**ï¼šå¯¼å…¥å“ªäº›ç»„ä»¶çš„é€‰æ‹©å™¨ï¼›

â€‹		å°†æ‰€æœ‰éœ€è¦å¯¼å…¥çš„ç»„ä»¶ä»¥å…¨ç±»åçš„æ–¹å¼è¿”å›ï¼›è¿™äº›ç»„ä»¶å°±ä¼šè¢«æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼›

â€‹		ä¼šç»™å®¹å™¨ä¸­å¯¼å…¥éå¸¸å¤šçš„è‡ªåŠ¨é…ç½®ç±»ï¼ˆxxxAutoConfigurationï¼‰ï¼›å°±æ˜¯ç»™å®¹å™¨ä¸­å¯¼å…¥è¿™ä¸ªåœºæ™¯éœ€è¦çš„æ‰€æœ‰ç»„ä»¶ï¼Œå¹¶é…ç½®å¥½è¿™äº›ç»„ä»¶ï¼›		![è‡ªåŠ¨é…ç½®ç±»](images/æœç‹—æˆªå›¾20180129224104.png)

æœ‰äº†è‡ªåŠ¨é…ç½®ç±»ï¼Œå…å»äº†æˆ‘ä»¬æ‰‹åŠ¨ç¼–å†™é…ç½®æ³¨å…¥åŠŸèƒ½ç»„ä»¶ç­‰çš„å·¥ä½œï¼›

â€‹		SpringFactoriesLoader.loadFactoryNames(EnableAutoConfiguration.class,classLoader)ï¼›

Spring Bootåœ¨å¯åŠ¨çš„æ—¶å€™ä»ç±»è·¯å¾„ä¸‹çš„META-INF/spring.factoriesä¸­è·å–EnableAutoConfigurationæŒ‡å®šçš„å€¼ï¼Œå°†è¿™äº›å€¼ä½œä¸ºè‡ªåŠ¨é…ç½®ç±»å¯¼å…¥åˆ°å®¹å™¨ä¸­ï¼Œè‡ªåŠ¨é…ç½®ç±»å°±ç”Ÿæ•ˆï¼Œå¸®æˆ‘ä»¬è¿›è¡Œè‡ªåŠ¨é…ç½®å·¥ä½œï¼›ä»¥å‰æˆ‘ä»¬éœ€è¦è‡ªå·±é…ç½®çš„ä¸œè¥¿ï¼Œè‡ªåŠ¨é…ç½®ç±»éƒ½å¸®æˆ‘ä»¬é…ç½®å¥½äº†ï¼›

J2EEçš„æ•´ä½“æ•´åˆè§£å†³æ–¹æ¡ˆå’Œè‡ªåŠ¨é…ç½®éƒ½åœ¨spring-boot-autoconfigure-1.5.9.RELEASE.jarï¼›

## 6. ä½¿ç”¨Spring Initializerå¿«é€Ÿåˆ›å»ºSpring Booté¡¹ç›®

### 6.1 IDEAï¼šä½¿ç”¨ Spring Initializerå¿«é€Ÿåˆ›å»ºé¡¹ç›®

IDEéƒ½æ”¯æŒä½¿ç”¨Springçš„é¡¹ç›®åˆ›å»ºå‘å¯¼å¿«é€Ÿåˆ›å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼›

é€‰æ‹©æˆ‘ä»¬éœ€è¦çš„æ¨¡å—ï¼›å‘å¯¼ä¼šè”ç½‘åˆ›å»ºSpring Booté¡¹ç›®ï¼›

é»˜è®¤ç”Ÿæˆçš„Spring Booté¡¹ç›®ï¼›

- ä¸»ç¨‹åºå·²ç»ç”Ÿæˆå¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç¼–å†™æˆ‘ä»¬è‡ªå·±çš„é€»è¾‘
- resourcesæ–‡ä»¶å¤¹ä¸­ç›®å½•ç»“æ„
  - staticï¼šä¿å­˜æ‰€æœ‰çš„é™æ€èµ„æºï¼› js css  imagesï¼›
  - templatesï¼šä¿å­˜æ‰€æœ‰çš„æ¨¡æ¿é¡µé¢ï¼›ï¼ˆSpring Booté»˜è®¤jaråŒ…ä½¿ç”¨åµŒå…¥å¼çš„Tomcatï¼Œé»˜è®¤ä¸æ”¯æŒJSPé¡µé¢ï¼‰ï¼›å¯ä»¥ä½¿ç”¨æ¨¡æ¿å¼•æ“ï¼ˆfreemarkerã€thymeleafï¼‰ï¼›
  - application.propertiesï¼šSpring Bootåº”ç”¨çš„é…ç½®æ–‡ä»¶ï¼›å¯ä»¥ä¿®æ”¹ä¸€äº›é»˜è®¤è®¾ç½®ï¼›

### 6.2 STSä½¿ç”¨ Spring Starter Projectå¿«é€Ÿåˆ›å»ºé¡¹ç›®



-------------



# äºŒã€é…ç½®æ–‡ä»¶

## 1. é…ç½®æ–‡ä»¶

SpringBootä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶åæ˜¯å›ºå®šçš„ï¼›

â€¢application.properties

â€¢application.yml

é…ç½®æ–‡ä»¶çš„ä½œç”¨ï¼šä¿®æ”¹SpringBootè‡ªåŠ¨é…ç½®çš„é»˜è®¤å€¼ï¼›SpringBootåœ¨åº•å±‚éƒ½ç»™æˆ‘ä»¬è‡ªåŠ¨é…ç½®å¥½ï¼›

YAMLï¼ˆYAML Ain't Markup Languageï¼‰

YAML  A Markup Languageï¼šæ˜¯ä¸€ä¸ªæ ‡è®°è¯­è¨€

YAML   isn't Markup Languageï¼šä¸æ˜¯ä¸€ä¸ªæ ‡è®°è¯­è¨€ï¼›

æ ‡è®°è¯­è¨€ï¼š

â€‹	ä»¥å‰çš„é…ç½®æ–‡ä»¶ï¼›å¤§å¤šéƒ½ä½¿ç”¨çš„æ˜¯  **xxxx.xml**æ–‡ä»¶ï¼›

â€‹	YAMLï¼š**ä»¥æ•°æ®ä¸ºä¸­å¿ƒ**ï¼Œæ¯”jsonã€xmlç­‰æ›´é€‚åˆåšé…ç½®æ–‡ä»¶ï¼›

YAMLï¼šé…ç½®ä¾‹å­

```yaml
server:
  port: 8081
```

XMLï¼š

```xml
<server>
	<port>8081</port>
</server>
```



## 2. YAMLè¯­æ³•ï¼š

### 2.1 åŸºæœ¬è¯­æ³•

k: vï¼šè¡¨ç¤ºä¸€å¯¹é”®å€¼å¯¹ï¼ˆç©ºæ ¼å¿…é¡»æœ‰ï¼‰ï¼›

ä»¥**ç©ºæ ¼**çš„ç¼©è¿›æ¥æ§åˆ¶å±‚çº§å…³ç³»ï¼›åªè¦æ˜¯å·¦å¯¹é½çš„ä¸€åˆ—æ•°æ®ï¼Œéƒ½æ˜¯åŒä¸€ä¸ªå±‚çº§çš„

```yaml
server:
    port: 8081
    path: /hello
```

å±æ€§å’Œå€¼ä¹Ÿæ˜¯å¤§å°å†™æ•æ„Ÿï¼›



### 2.2 å€¼çš„å†™æ³•

- å­—é¢é‡ï¼šæ™®é€šçš„å€¼ï¼ˆæ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå¸ƒå°”ï¼‰

  > k: vï¼šå­—é¢ç›´æ¥æ¥å†™ï¼›
  >
  > å­—ç¬¦ä¸²é»˜è®¤ä¸ç”¨åŠ ä¸Šå•å¼•å·æˆ–è€…åŒå¼•å·ï¼›
  >
  > â€‹		""ï¼šåŒå¼•å·ï¼›ä¸ä¼šè½¬ä¹‰å­—ç¬¦ä¸²é‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦ï¼›ç‰¹æ®Šå­—ç¬¦ä¼šä½œä¸ºæœ¬èº«æƒ³è¡¨ç¤ºçš„æ„æ€
  >
  > â€‹				name:   "zhangsan \n lisi"ï¼šè¾“å‡ºï¼›zhangsan æ¢è¡Œ  lisi
  >
  > â€‹		''ï¼šå•å¼•å·ï¼›ä¼šè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼Œç‰¹æ®Šå­—ç¬¦æœ€ç»ˆåªæ˜¯ä¸€ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²æ•°æ®
  >
  > â€‹				name:   â€˜zhangsan \n lisiâ€™ï¼šè¾“å‡ºï¼›zhangsan \n  lisi

â€‹		

- å¯¹è±¡ã€Mapï¼ˆå±æ€§å’Œå€¼ï¼‰ï¼ˆé”®å€¼å¯¹ï¼‰ï¼š

>  k: vï¼šåœ¨ä¸‹ä¸€è¡Œæ¥å†™å¯¹è±¡çš„å±æ€§å’Œå€¼çš„å…³ç³»ï¼›æ³¨æ„ç¼©è¿›
>
> å¯¹è±¡è¿˜æ˜¯k: vçš„æ–¹å¼
>
> ```yaml
> friends:
> 		lastName: zhangsan
> 		age: 20
> ```
>
> è¡Œå†…å†™æ³•ï¼š
>
> ```yaml
> friends: {lastName: zhangsan,age: 18}
> ```
>
> â€‹	

- æ•°ç»„ï¼ˆListã€Setï¼‰ï¼š

> ç”¨- å€¼è¡¨ç¤ºæ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ 
>
> ```YAML
> pets:
>  - cat
>  - dog
>  - pig
> ```
>
> è¡Œå†…å†™æ³•
>
> ```YAML
> pets: [cat,dog,pig]
> ```
>
> 



## 3. é…ç½®æ–‡ä»¶å€¼æ³¨å…¥

é…ç½®æ–‡ä»¶:

```yaml
person:
    lastName: hello
    age: 18
    boss: false
    birth: 2017/12/12
    maps: {k1: v1,k2: 12}
    lists:
      - lisi
      - zhaoliu
    dog:
      name: å°ç‹—
      age: 12
```

javaBeanï¼š

```java
/**
 * å°†é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æ¯ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œæ˜ å°„åˆ°è¿™ä¸ªç»„ä»¶ä¸­
 * @ConfigurationPropertiesï¼šå‘Šè¯‰SpringBootå°†æœ¬ç±»ä¸­çš„æ‰€æœ‰å±æ€§å’Œé…ç½®æ–‡ä»¶ä¸­ç›¸å…³çš„é…ç½®è¿›è¡Œç»‘å®šï¼›
 *      prefix = "person"ï¼šé…ç½®æ–‡ä»¶ä¸­å“ªä¸ªä¸‹é¢çš„æ‰€æœ‰å±æ€§è¿›è¡Œä¸€ä¸€æ˜ å°„
 *
 * åªæœ‰è¿™ä¸ªç»„ä»¶æ˜¯å®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œæ‰èƒ½å®¹å™¨æä¾›çš„@ConfigurationPropertiesåŠŸèƒ½ï¼›
 *
 */
@Component
@ConfigurationProperties(prefix = "person")
public class Person {

    private String lastName;
    private Integer age;
    private Boolean boss;
    private Date birth;

    private Map<String,Object> maps;
    private List<Object> lists;
    private Dog dog;

```



æˆ‘ä»¬å¯ä»¥å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œä»¥åç¼–å†™é…ç½®å°±æœ‰æç¤ºäº†

```xml
<!--å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œé…ç½®æ–‡ä»¶è¿›è¡Œç»‘å®šå°±ä¼šæœ‰æç¤º-->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-configuration-processor</artifactId>
			<optional>true</optional>
		</dependency>
```

#### 3.1 propertiesé…ç½®æ–‡ä»¶åœ¨ideaä¸­é»˜è®¤utf-8å¯èƒ½ä¼šä¹±ç 

![image-20200531023223202](https://x2-wrx.oss-cn-beijing.aliyuncs.com/img/image-20200531023223202.png)

#### 3.2 @Valueè·å–å€¼å’Œ@ConfigurationPropertiesè·å–å€¼æ¯”è¾ƒ

|            | @ConfigurationProperties | @Value |
| ---------- | ------------------------ | ------ |
| åŠŸèƒ½         | æ‰¹é‡æ³¨å…¥é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§             | ä¸€ä¸ªä¸ªæŒ‡å®š  |
| æ¾æ•£ç»‘å®šï¼ˆæ¾æ•£è¯­æ³•ï¼‰ | æ”¯æŒ                       | ä¸æ”¯æŒ    |
| SpEL       | ä¸æ”¯æŒ                      | æ”¯æŒ     |
| JSR303æ•°æ®æ ¡éªŒ | æ”¯æŒ                       | ä¸æ”¯æŒ    |
| å¤æ‚ç±»å‹å°è£…     | æ”¯æŒ                       | ä¸æ”¯æŒ    |

é…ç½®æ–‡ä»¶ymlè¿˜æ˜¯propertiesä»–ä»¬éƒ½èƒ½è·å–åˆ°å€¼ï¼›

å¦‚æœè¯´ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨æŸä¸ªä¸šåŠ¡é€»è¾‘ä¸­éœ€è¦è·å–ä¸€ä¸‹é…ç½®æ–‡ä»¶ä¸­çš„æŸé¡¹å€¼ï¼Œä½¿ç”¨@Valueï¼›

å¦‚æœè¯´ï¼Œæˆ‘ä»¬ä¸“é—¨ç¼–å†™äº†ä¸€ä¸ªjavaBeanæ¥å’Œé…ç½®æ–‡ä»¶è¿›è¡Œæ˜ å°„ï¼Œæˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨@ConfigurationPropertiesï¼›



#### 3.3 é…ç½®æ–‡ä»¶æ³¨å…¥å€¼æ•°æ®æ ¡éªŒ

```java
@Component
@ConfigurationProperties(prefix = "person")
@Validated
public class Person {

    /**
     * <bean class="Person">
     *      <property name="lastName" value="å­—é¢é‡/${key}ä»ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ä¸­è·å–å€¼/#{SpEL}"></property>
     * <bean/>
     */

   //lastNameå¿…é¡»æ˜¯é‚®ç®±æ ¼å¼
    @Email
    //@Value("${person.last-name}")
    private String lastName;
    //@Value("#{11*2}")
    private Integer age;
    //@Value("true")
    private Boolean boss;

    private Date birth;
    private Map<String,Object> maps;
    private List<Object> lists;
    private Dog dog;
```



#### 3.4 @PropertySource&@ImportResource&@Bean

- @**PropertySource**ï¼šåŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶ï¼›

```java
/**
 * å°†é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æ¯ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œæ˜ å°„åˆ°è¿™ä¸ªç»„ä»¶ä¸­
 * @ConfigurationPropertiesï¼šå‘Šè¯‰SpringBootå°†æœ¬ç±»ä¸­çš„æ‰€æœ‰å±æ€§å’Œé…ç½®æ–‡ä»¶ä¸­ç›¸å…³çš„é…ç½®è¿›è¡Œç»‘å®šï¼›
 *      prefix = "person"ï¼šé…ç½®æ–‡ä»¶ä¸­å“ªä¸ªä¸‹é¢çš„æ‰€æœ‰å±æ€§è¿›è¡Œä¸€ä¸€æ˜ å°„
 *
 * åªæœ‰è¿™ä¸ªç»„ä»¶æ˜¯å®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œæ‰èƒ½å®¹å™¨æä¾›çš„@ConfigurationPropertiesåŠŸèƒ½ï¼›
 *  @ConfigurationProperties(prefix = "person")é»˜è®¤ä»å…¨å±€é…ç½®æ–‡ä»¶ä¸­è·å–å€¼ï¼›
 *
 */
@PropertySource(value = {"classpath:person.properties"})
@Component
@ConfigurationProperties(prefix = "person")
//@Validated
public class Person {

    /**
     * <bean class="Person">
     *      <property name="lastName" value="å­—é¢é‡/${key}ä»ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ä¸­è·å–å€¼/#{SpEL}"></property>
     * <bean/>
     */

   //lastNameå¿…é¡»æ˜¯é‚®ç®±æ ¼å¼
   // @Email
    //@Value("${person.last-name}")
    private String lastName;
    //@Value("#{11*2}")
    private Integer age;
    //@Value("true")
    private Boolean boss;

```



- @**ImportResource**ï¼šå¯¼å…¥Springçš„é…ç½®æ–‡ä»¶ï¼Œè®©é…ç½®æ–‡ä»¶é‡Œé¢çš„å†…å®¹ç”Ÿæ•ˆï¼›

Spring Booté‡Œé¢æ²¡æœ‰Springçš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è‡ªåŠ¨è¯†åˆ«ï¼›

æƒ³è®©Springçš„é…ç½®æ–‡ä»¶ç”Ÿæ•ˆï¼ŒåŠ è½½è¿›æ¥ï¼›@**ImportResource**æ ‡æ³¨åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸Š

```java
@ImportResource(locations = {"classpath:beans.xml"})
å¯¼å…¥Springçš„é…ç½®æ–‡ä»¶è®©å…¶ç”Ÿæ•ˆ
```

æœ¬æ¥ç¼–å†™Springçš„é…ç½®æ–‡ä»¶

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">


    <bean id="helloService" class="com.atguigu.springboot.service.HelloService"></bean>
</beans>
```

SpringBootæ¨èç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶çš„æ–¹å¼ï¼›æ¨èä½¿ç”¨å…¨æ³¨è§£çš„æ–¹å¼

1ã€é…ç½®ç±»**@Configuration**------>Springé…ç½®æ–‡ä»¶

2ã€ä½¿ç”¨**@Bean**ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶

```java
/**
 * @Configurationï¼šæŒ‡æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼›å°±æ˜¯æ¥æ›¿ä»£ä¹‹å‰çš„Springé…ç½®æ–‡ä»¶
 *
 * åœ¨é…ç½®æ–‡ä»¶ä¸­ç”¨<bean><bean/>æ ‡ç­¾æ·»åŠ ç»„ä»¶
 *
 */
@Configuration
public class MyAppConfig {

    //å°†æ–¹æ³•çš„è¿”å›å€¼æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼›å®¹å™¨ä¸­è¿™ä¸ªç»„ä»¶é»˜è®¤çš„idå°±æ˜¯æ–¹æ³•å
    @Bean
    public HelloService helloService02(){
        System.out.println("é…ç½®ç±»@Beanç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶äº†...");
        return new HelloService();
    }
}
```

## 4. é…ç½®æ–‡ä»¶å ä½ç¬¦

1. éšæœºæ•°

${random.value}ã€${random.int}ã€${random.long}
${random.int(10)}ã€${random.int[1024,65536]}

2. è·å–ä¹‹å‰é…ç½®çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥ä½¿ç”¨:æŒ‡å®šå€¼ã€‚

```properties
person.last-name=å¼ ä¸‰${random.uuid}
person.age=${random.int}
person.birth=2017/12/15
person.boss=false
person.maps.k1=v1
person.maps.k2=14
person.lists=a,b,c
person.dog.name=${person.hello:hello}_dog
person.dog.age=15
```

## 5. Profile

1. å¤šprofieæ–‡ä»¶

   æˆ‘ä»¬åœ¨ä¸»é…ç½®æ–‡ä»¶ç¼–å†™çš„æ—¶å€™ï¼Œæ–‡ä»¶åå¯ä»¥æ˜¯application-(profile).propertoes/yml

   é»˜è®¤ä½¿ç”¨application.propertiesçš„é…ç½®æ–‡ä»¶ã€‚

2. ymlæ”¯æŒå¤šæ–‡æ¡£å—æ–¹å¼

   ```yaml
   
   server:
     port: 8081
   spring:
     profiles:
       active: prod
   
   ---
   server:
     port: 8083
   spring:
     profiles: dev
   
    
   ---
   
   server:
     port: 8084
   spring:
     profiles: prod  #æŒ‡å®šå±äºå“ªç§ç¯å¢ƒ
   ```

   

3. æ¿€æ´»æŒ‡å®šProfile

   1. åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šspring.profiles.actice=dev

   2. å‘½ä»¤è¡Œ

      java -jar spring-boot-02-config-0.0.1-SNAPSHOT.jar --spring.profiles.active=dev;

      å¯ä»¥ç›´æ¥åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œé…ç½®ä¼ å…¥å‘½ä»¤è¡Œå‚æ•°ã€‚

   3. è™šæ‹Ÿæœºå‚æ•°

      -Dspring.profiles.active=dev

      ![image-20200531192456919](https://x2-wrx.oss-cn-beijing.aliyuncs.com/img/image-20200531192456919.png)

## 6. é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®

Spring  Bootå¯åŠ¨ä¼šæ‰«æä»¥ä¸‹ä½ç½®çš„application.properties/ymlæ–‡ä»¶ä½œä¸ºSpring Bootçš„é»˜è®¤é…ç½®æ–‡ä»¶ã€‚ä¼˜å…ˆçº§ç”±é«˜åˆ°ä½å¦‚ä¸‹æ‰€ç¤ºï¼š

- file:./config/
- file:./
- classpath:/config/
- classpath:/

é«˜ä¼˜å…ˆçº§é…ç½®ä¼šè¦†ç›–ä½ä¼˜å…ˆçº§é…ç½®ã€‚ä½†æ˜¯Springä¼šå°†è¿™å››ä¸ªä½ç½®çš„ä¸»é…ç½®æ–‡ä»¶å…¨éƒ¨åŠ è½½ã€‚**äº’è¡¥é…ç½®**ï¼›

==æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡spring.config.locationæ¥æ”¹å˜é»˜è®¤çš„é…ç½®æ–‡ä»¶ä½ç½®==

é¡¹ç›®æ‰“åŒ…å¥½ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°çš„å½¢å¼ï¼Œå¯åŠ¨é¡¹ç›®çš„æ—¶å€™æ¥æŒ‡å®šé…ç½®æ–‡ä»¶çš„æ–°ä½ç½®ï¼Œ**æŒ‡å®šçš„é…ç½®æ–‡ä»¶ä¼šå’Œé»˜è®¤åŠ è½½çš„åªå†™é…ç½®æ–‡ä»¶å…±åŒèµ·ä½œç”¨ï¼Œå½¢æˆäº’è¡¥é…ç½®ã€‚**

## 7. å¤–éƒ¨é…ç½®åŠ è½½é¡ºåº

Spring Bootä¹Ÿå¯ä»¥ä»ä»¥ä¸‹ä½ç½®åŠ è½½é…ç½®ï¼›ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼›é«˜ä¼˜å…ˆçº§çš„é…ç½®è¦†ç›–ä½ä¼˜å…ˆçº§çš„é…ç½®ï¼Œæ‰€æœ‰çš„é…ç½®ä¼šå½¢æˆäº’è¡¥é…ç½®ã€‚

1. ğŸ”ºå‘½ä»¤è¡Œå‚æ•°

>  æ‰€æœ‰çš„é…ç½®éƒ½å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸Šè¿›è¡ŒæŒ‡å®š
>
> java -jar spring-boot-02-config-02-0.0.1-SNAPSHOT.jar --server.port=8087  --server.servlet.context-path=/abc
>
> å¤šä¸ªé…ç½®ç”¨ç©ºæ ¼åˆ†å¼€ï¼› --é…ç½®é¡¹=å€¼
>

2. æ¥è‡ªjava:comp/envçš„JNDIå±æ€§
3. Javaç³»ç»Ÿå±æ€§ï¼ˆSystem.getProperties()ï¼‰
4. æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡
5. RandomValuePropertySourceé…ç½®çš„random.*å±æ€§å€¼



==**ç”±jaråŒ…å¤–å‘jaråŒ…å†…è¿›è¡Œå¯»æ‰¾ï¼›**== 

**ä¼˜å…ˆåŠ è½½å¸¦profile**

6. ğŸ”ºjaråŒ…å¤–éƒ¨çš„application-{profile}.propertiesæˆ–application.yml(å¸¦spring.profile)é…ç½®æ–‡ä»¶

7. ğŸ”ºjaråŒ…å†…éƒ¨çš„application-{profile}.propertiesæˆ–application.yml(å¸¦spring.profile)é…ç½®æ–‡ä»¶

**å†æ¥åŠ è½½ä¸å¸¦profile**

8. ğŸ”ºjaråŒ…å¤–éƒ¨çš„application.propertiesæˆ–application.yml(ä¸å¸¦spring.profile)é…ç½®æ–‡ä»¶

9. ğŸ”ºjaråŒ…å†…éƒ¨çš„application.propertiesæˆ–application.yml(ä¸å¸¦spring.profile)é…ç½®æ–‡ä»¶

10. @Configurationæ³¨è§£ç±»ä¸Šçš„@PropertySource

11. é€šè¿‡SpringApplication.setDefaultPropertiesæŒ‡å®šçš„é»˜è®¤å±æ€§

æ‰€æœ‰æ”¯æŒçš„é…ç½®åŠ è½½æ¥æºï¼›[å‚è€ƒå®˜ç½‘](https://docs.spring.io/spring-boot/docs/2.3.0.RELEASE/reference/html/spring-boot-features.html#boot-features-external-config)ã€‚

## 8. è‡ªåŠ¨é…ç½®åŸç†

é…ç½®æ–‡ä»¶åˆ°åº•èƒ½å†™ä»€ä¹ˆï¼Ÿæ€ä¹ˆå†™ï¼Ÿè‡ªåŠ¨é…ç½®åŸç†ï¼›

[é…ç½®æ–‡ä»¶èƒ½é…ç½®çš„å±æ€§å‚ç…§](https://docs.spring.io/spring-boot/docs/2.3.0.RELEASE/reference/html/appendix-application-properties.html#core-properties)

**è‡ªåŠ¨é…ç½®åŸç†ï¼š**

1. SpringBootå¯åŠ¨çš„æ—¶å€™åŠ è½½ä¸»é…ç½®ç±»ï¼Œå¼€å¯äº†è‡ªåŠ¨é…ç½®åŠŸèƒ½ ==@EnableAutoConfiguration==

   > @EnableAutoConfiguration ä½œç”¨ï¼š
   >
   > - åˆ©ç”¨EnableAutoConfigurationImportSelectorç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€äº›ç»„ä»¶
   >
   >   å“ªäº›ç»„ä»¶å¯ä»¥æŸ¥çœ‹selectImports()æ–¹æ³•çš„å†…å®¹:List<String> configurations = getCandidateConfigurations(annotationMetadata, attributes);è·å–å€™é€‰çš„é…ç½®
   >
   >   ```
   >   SpringFactoriesLoader.loadFactoryNames(this.getSpringFactoriesLoaderFactoryClass(), this.getBeanClassLoader());
   >   æ‰«ææ‰€æœ‰JaråŒ…ç±»è·¯å¾„ä¸‹META-INF/spring.factories
   >   æŠŠæ‰«æåˆ°çš„è¿™äº›æ–‡ä»¶çš„å†…è“‰åŒ…è£…æˆpropertieså¯¹è±¡
   >   ä»propertiesè·å–åˆ°EnableAutoConfiguration.classç±»(ç±»å)å¯¹åº”çš„å€¼,ç„¶åæŠŠå®ƒä»¬æ·»åŠ åœ¨å®¹å™¨ä¸­
   >   ```
   >   
   >   ==å°†ç±»è·¯å¾„ä¸‹META-INF/spring.factoriesé‡Œé¢é…ç½®çš„æ‰€æœ‰EnableAutoConfigurationçš„å€¼åŠ å…¥åˆ°äº†å®¹å™¨ä¸­==

```properties
# Auto Configure
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\
org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\
org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration,\
org.springframework.boot.autoconfigure.batch.BatchAutoConfiguration,\
org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration,\
org.springframework.boot.autoconfigure.cassandra.CassandraAutoConfiguration,\
org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration,\
org.springframework.boot.autoconfigure.context.LifecycleAutoConfiguration,\
org.springframework.boot.autoconfigure.context.MessageSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration,\
org.springframework.boot.autoconfigure.couchbase.CouchbaseAutoConfiguration,\
org.springframework.boot.autoconfigure.dao.PersistenceExceptionTranslationAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.cassandra.CassandraRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.couchbase.CouchbaseRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ElasticsearchRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ReactiveElasticsearchRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.elasticsearch.ReactiveElasticsearchRestClientAutoConfiguration,\
org.springframework.boot.autoconfigure.data.jdbc.JdbcRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.ldap.LdapRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoReactiveDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoReactiveRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.mongo.MongoRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.neo4j.Neo4jRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.solr.SolrRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.r2dbc.R2dbcDataAutoConfiguration,\
org.springframework.boot.autoconfigure.data.r2dbc.R2dbcRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.r2dbc.R2dbcTransactionManagerAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration,\
org.springframework.boot.autoconfigure.data.rest.RepositoryRestMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.data.web.SpringDataWebAutoConfiguration,\
org.springframework.boot.autoconfigure.elasticsearch.ElasticsearchRestClientAutoConfiguration,\
org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration,\
org.springframework.boot.autoconfigure.freemarker.FreeMarkerAutoConfiguration,\
org.springframework.boot.autoconfigure.groovy.template.GroovyTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration,\
org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration,\
org.springframework.boot.autoconfigure.hateoas.HypermediaAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastAutoConfiguration,\
org.springframework.boot.autoconfigure.hazelcast.HazelcastJpaDependencyAutoConfiguration,\
org.springframework.boot.autoconfigure.http.HttpMessageConvertersAutoConfiguration,\
org.springframework.boot.autoconfigure.http.codec.CodecsAutoConfiguration,\
org.springframework.boot.autoconfigure.influx.InfluxDbAutoConfiguration,\
org.springframework.boot.autoconfigure.info.ProjectInfoAutoConfiguration,\
org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration,\
org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.JndiDataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.XADataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JmsAutoConfiguration,\
org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.JndiConnectionFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.activemq.ActiveMQAutoConfiguration,\
org.springframework.boot.autoconfigure.jms.artemis.ArtemisAutoConfiguration,\
org.springframework.boot.autoconfigure.jersey.JerseyAutoConfiguration,\
org.springframework.boot.autoconfigure.jooq.JooqAutoConfiguration,\
org.springframework.boot.autoconfigure.jsonb.JsonbAutoConfiguration,\
org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration,\
org.springframework.boot.autoconfigure.availability.ApplicationAvailabilityAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration,\
org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,\
org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderAutoConfiguration,\
org.springframework.boot.autoconfigure.mail.MailSenderValidatorAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration,\
org.springframework.boot.autoconfigure.mongo.MongoReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.mustache.MustacheAutoConfiguration,\
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\
org.springframework.boot.autoconfigure.quartz.QuartzAutoConfiguration,\
org.springframework.boot.autoconfigure.r2dbc.R2dbcAutoConfiguration,\
org.springframework.boot.autoconfigure.rsocket.RSocketMessagingAutoConfiguration,\
org.springframework.boot.autoconfigure.rsocket.RSocketRequesterAutoConfiguration,\
org.springframework.boot.autoconfigure.rsocket.RSocketServerAutoConfiguration,\
org.springframework.boot.autoconfigure.rsocket.RSocketStrategiesAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration,\
org.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration,\
org.springframework.boot.autoconfigure.security.reactive.ReactiveSecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration,\
org.springframework.boot.autoconfigure.security.rsocket.RSocketSecurityAutoConfiguration,\
org.springframework.boot.autoconfigure.security.saml2.Saml2RelyingPartyAutoConfiguration,\
org.springframework.boot.autoconfigure.sendgrid.SendGridAutoConfiguration,\
org.springframework.boot.autoconfigure.session.SessionAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.client.reactive.ReactiveOAuth2ClientAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.resource.servlet.OAuth2ResourceServerAutoConfiguration,\
org.springframework.boot.autoconfigure.security.oauth2.resource.reactive.ReactiveOAuth2ResourceServerAutoConfiguration,\
org.springframework.boot.autoconfigure.solr.SolrAutoConfiguration,\
org.springframework.boot.autoconfigure.task.TaskExecutionAutoConfiguration,\
org.springframework.boot.autoconfigure.task.TaskSchedulingAutoConfiguration,\
org.springframework.boot.autoconfigure.thymeleaf.ThymeleafAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration,\
org.springframework.boot.autoconfigure.transaction.jta.JtaAutoConfiguration,\
org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration,\
org.springframework.boot.autoconfigure.web.client.RestTemplateAutoConfiguration,\
org.springframework.boot.autoconfigure.web.embedded.EmbeddedWebServerFactoryCustomizerAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.HttpHandlerAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.ReactiveWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.WebFluxAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.error.ErrorWebFluxAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.function.client.ClientHttpConnectorAutoConfiguration,\
org.springframework.boot.autoconfigure.web.reactive.function.client.WebClientAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.reactive.WebSocketReactiveAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.servlet.WebSocketServletAutoConfiguration,\
org.springframework.boot.autoconfigure.websocket.servlet.WebSocketMessagingAutoConfiguration,\
org.springframework.boot.autoconfigure.webservices.WebServicesAutoConfiguration,\
org.springframework.boot.autoconfigure.webservices.client.WebServiceTemplateAutoConfiguration
```

æ¯ä¸€ä¸ªè¿™æ ·çš„xxxAutoConfigurationç±»éƒ½æ˜¯å®¹å™¨ä¸­çš„ä¸€ä¸ªç»„ä»¶,éƒ½åŠ å…¥åˆ°å®¹å™¨ä¸­;ç”¨ä»–ä»¬æ¥åšè‡ªåŠ¨é…ç½®;==æ¯ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»è¿›è¡Œè‡ªåŠ¨é…ç½®åŠŸèƒ½==

**ä»¥HttpEncodingAutoConfigurationä¸ºä¾‹è§£é‡Šè‡ªåŠ¨é…ç½®åŸç†:**

```java
@Configuration(     //è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»,å’Œä»¥å‰ç¼–å†™çš„é…ç½®æ–‡ä»¶ä¸€æ ·,ä¹Ÿå¯ä»¥ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶
    proxyBeanMethods = false
)
@EnableConfigurationProperties({ServerProperties.class})   //å¯ç”¨æŒ‡å®šç±»çš„ConfigurationPropertiesåŠŸèƒ½:å°†é…ç½®æ–‡ä»¶ä¸­å¯¹åº”çš„å€¼å’ŒServerPropertiesç»‘å®šèµ·æ¥,å¹¶æŠŠHttpEncodingAutoConfigurationåŠ å…¥åˆ°Springå®¹å™¨ä¸­
@ConditionalOnWebApplication(    //Springåº•å±‚@Conditionalæ³¨è§£ ,æ ¹æ®ä¸åŒçš„æ¡ä»¶,å¦‚æœæ»¡è¶³æŒ‡å®šçš„æ¡ä»¶,æ•´ä¸ªé…ç½®ç±»é‡Œé¢çš„é…ç½®å°±ä¼šç”Ÿæ•ˆ    åˆ¤æ–­å½“å‰åº”ç”¨æ˜¯å¦æ˜¯webåº”ç”¨
    type = Type.SERVLET
)
@ConditionalOnClass({CharacterEncodingFilter.class})  //åˆ¤æ–­å½“å‰é¡¹ç›®æœ‰æ²¡æœ‰è¿™ä¸ªç±»   CharacterEncodingFilter:SpringMVCä¸­è¿›è¡Œ`ä¹±ç è§£å†³çš„è¿‡æ»¤å™¨
@ConditionalOnProperty(      //åˆ¤æ–­é…ç½®æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªé…ç½®    server.servlet.encoding  matchIfMissing = true:å¦‚æœä¸å­˜åœ¨,ä¹Ÿæ˜¯æˆç«‹çš„,å³å³ä½¿server.servlet.encoding=enableä¸å­˜åœ¨
    prefix = "server.servlet.encoding",
    value = {"enabled"},
    matchIfMissing = true
)
ublic class HttpEncodingAutoConfiguration {

    //å®ƒå·²ç»å’ŒSpringBootçš„é…ç½®æ–‡ä»¶æ˜ å°„äº†
	private final Encoding properties;

    //åªæœ‰ä¸€ä¸ªæœ‰å‚æ„é€ å™¨çš„æƒ…å†µä¸‹,å‚æ•°çš„å€¼å°±ä¼šä»å®¹å™¨ä¸­æ‹¿
	public HttpEncodingAutoConfiguration(ServerProperties properties) {
		this.properties = properties.getServlet().getEncoding();
	}

	@Bean     //ç»™å®¹å™¨ä¸­æ·»åŠ ä¸€ä¸ªç»„ä»¶,è¿™ä¸ªç»„ä»¶çš„æŸäº›å€¼éœ€è¦ä»propertiesä¸­è·å–
	@ConditionalOnMissingBean   //æ²¡æœ‰è¿™ä¸ªç»„ä»¶å°±åŠ 
	public CharacterEncodingFilter characterEncodingFilter() {
		CharacterEncodingFilter filter = new OrderedCharacterEncodingFilter();
		filter.setEncoding(this.properties.getCharset().name());
		filter.setForceRequestEncoding(this.properties.shouldForce(Encoding.Type.REQUEST));
		filter.setForceResponseEncoding(this.properties.shouldForce(Encoding.Type.RESPONSE));
		return filter;
	}
```

æ ¹æ®å½“å‰ä¸åŒçš„æ¡ä»¶åˆ¤æ–­,å†³å®šè¿™ä¸ªé…ç½®ç±»æ˜¯å¦ç”Ÿæ•ˆ?

ä¸€æ—¦è¿™ä¸ªé…ç½®ç±»ç”Ÿæ•ˆ,è¿™ä¸ªé…ç½®ç±»å°±ä¼šç»™å®¹å™¨ä¸­æ·»åŠ å„ç§ç»„ä»¶,è¿™äº›ç»„ä»¶çš„å±æ€§æ˜¯ä»å¯¹åº”çš„propertiesç±»ä¸­è·å–çš„,è¿™äº›ç±»é‡Œé¢çš„æ¯ä¸€ä¸ªå±æ€§åˆæ˜¯å’Œé…ç½®æ–‡ä»¶ç»‘å®šçš„ã€‚

æ‰€æœ‰åœ¨é…ç½®æ–‡ä»¶ä¸­èƒ½é…ç½®çš„å±æ€§éƒ½æ˜¯åœ¨xxxPropertiesç±»ä¸­å°è£…ç€;é…ç½®æ–‡ä»¶èƒ½é…ç½®ä»€ä¹ˆå°±å¯ä»¥å‚ç…§æŸä¸ªåŠŸèƒ½å¯¹åº”çš„å±æ€§ç±»

```properties
@ConfigurationProperties(prefix = "server", ignoreUnknownFields = true)//ä»é…ç½®æ–‡ä»¶
public class ServerProperties {
```

1.æˆ‘æ˜¯è¿™æ ·ç†è§£çš„Springbootå¯åŠ¨çš„æ—¶å€™é€šè¿‡@EnabIeConfigurationå†…çš„seIectImportæ–¹æ³•æ‰¾åˆ°Spring. facotriesæ–‡ä»¶ä¸­çš„æ‰€æœ‰é…ç½®ç±»å¹¶åŠ è½½

2è€Œæˆ‘ä»¬åœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®é€šè¿‡@ConfigurationPropertiesç»‘å®šåˆ°ç›¸å¯¹åº”çš„Propertiesç»“å°¾çš„é…ç½®ç±»

3å¹¶é€šè¿‡@EnableConfigurationPropertiesæ³¨è§£å°†propertiesç¸¾å°¾çš„é…ç½®ç±»æ³¨å…¥åˆ°springå®¹å™¨ä¸­



**ç²¾é«“ï¼š**

1. **SpringBootå¯åŠ¨åä¼šåŠ è½½å¤§é‡çš„è‡ªåŠ¨é…ç½®ç±»**
2. **æˆ‘ä»¬çœ‹æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½æœ‰æ²¡æœ‰SpringBooté»˜è®¤å†™å¥½çš„è‡ªåŠ¨é…ç½®ç±»**
3. **æˆ‘ä¹ˆå†æ¥çœ‹è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»ä¸­åˆ°åº•é…ç½®äº†å“ªäº›ç»„ä»¶ï¼›åªè¦æˆ‘ä»¬è¦ç”¨çš„ç»„ä»¶æœ‰ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦é…ç½®äº†**
4. **ç»™å®¹å™¨ä¸­è‡ªåŠ¨é…ç½®ç±»æ·»åŠ ç»„ä»¶çš„æ—¶å€™ï¼Œä¼šä»propertiesç±»ä¸­è·å–æŸäº›å±æ€§ã€‚æˆ‘ä»¬å°±å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šè¿™äº›å±æ€§çš„å€¼ã€‚**

<span style="font-size:50px;color:red">ç»†èŠ‚</span>

**@Conditionalæ´¾ç”Ÿæ³¨è§£**

ä½œç”¨ï¼šå¿…é¡»æ˜¯@ConditionalæŒ‡å®šçš„æ¡ä»¶æˆç«‹ï¼Œæ‰ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ï¼Œé…ç½®é…é‡Œé¢çš„æ‰€æœ‰å†…å®¹æ‰ç”Ÿæ•ˆï¼›

| @Conditionalæ‰©å±•æ³¨è§£            | ä½œç”¨ï¼ˆåˆ¤æ–­æ˜¯å¦æ»¡è¶³å½“å‰æŒ‡å®šæ¡ä»¶ï¼‰                 |
| ------------------------------- | ------------------------------------------------ |
| @ConditionalOnJava              | ç³»ç»Ÿçš„javaç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚                       |
| @ConditionalOnBean              | å®¹å™¨ä¸­å­˜åœ¨æŒ‡å®šBeanï¼›                             |
| @ConditionalOnMissingBean       | å®¹å™¨ä¸­ä¸å­˜åœ¨æŒ‡å®šBeanï¼›                           |
| @ConditionalOnExpression        | æ»¡è¶³SpELè¡¨è¾¾å¼æŒ‡å®š                               |
| @ConditionalOnClass             | ç³»ç»Ÿä¸­æœ‰æŒ‡å®šçš„ç±»                                 |
| @ConditionalOnMissingClass      | ç³»ç»Ÿä¸­æ²¡æœ‰æŒ‡å®šçš„ç±»                               |
| @ConditionalOnSingleCandidate   | å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªæŒ‡å®šçš„Beanï¼Œæˆ–è€…è¿™ä¸ªBeanæ˜¯é¦–é€‰Bean |
| @ConditionalOnProperty          | ç³»ç»Ÿä¸­æŒ‡å®šçš„å±æ€§æ˜¯å¦æœ‰æŒ‡å®šçš„å€¼                   |
| @ConditionalOnResource          | ç±»è·¯å¾„ä¸‹æ˜¯å¦å­˜åœ¨æŒ‡å®šèµ„æºæ–‡ä»¶                     |
| @ConditionalOnWebApplication    | å½“å‰æ˜¯webç¯å¢ƒ                                    |
| @ConditionalOnNotWebApplication | å½“å‰ä¸æ˜¯webç¯å¢ƒ                                  |
| @ConditionalOnJndi              | JNDIå­˜åœ¨æŒ‡å®šé¡¹                                   |

**è‡ªåŠ¨é…ç½®ç±»å¿…é¡»åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹æ‰èƒ½ç”Ÿæ•ˆï¼›**

æˆ‘ä»¬æ€ä¹ˆçŸ¥é“å“ªäº›è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆï¼›

**==æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨  debug=trueå±æ€§ï¼›å¯ç”¨debugæ¨¡å¼æ¥è®©æ§åˆ¶å°æ‰“å°è‡ªåŠ¨é…ç½®æŠ¥å‘Š==**ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„çŸ¥é“å“ªäº›è‡ªåŠ¨é…ç½®ç±»ç”Ÿæ•ˆï¼›

```java
=========================
AUTO-CONFIGURATION REPORT
=========================


Positive matches:ï¼ˆè‡ªåŠ¨é…ç½®ç±»å¯ç”¨çš„ï¼‰
-----------------

   DispatcherServletAutoConfiguration matched:
      - @ConditionalOnClass found required class 'org.springframework.web.servlet.DispatcherServlet'; @ConditionalOnMissingClass did not find unwanted class (OnClassCondition)
      - @ConditionalOnWebApplication (required) found StandardServletEnvironment (OnWebApplicationCondition)
        
    
Negative matches:ï¼ˆæ²¡æœ‰å¯åŠ¨ï¼Œæ²¡æœ‰åŒ¹é…æˆåŠŸçš„è‡ªåŠ¨é…ç½®ç±»ï¼‰
-----------------

   ActiveMQAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required classes 'javax.jms.ConnectionFactory', 'org.apache.activemq.ActiveMQConnectionFactory' (OnClassCondition)

   AopAutoConfiguration:
      Did not match:
         - @ConditionalOnClass did not find required classes 'org.aspectj.lang.annotation.Aspect', 'org.aspectj.lang.reflect.Advice' (OnClassCondition)
        
```

